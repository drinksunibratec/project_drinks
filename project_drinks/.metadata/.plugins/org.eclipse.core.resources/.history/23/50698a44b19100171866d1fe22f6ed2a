package dados;

import java.util.List;

import javax.persistence.EntityManager;
import javax.persistence.EntityManagerFactory;
import javax.persistence.Query;

import basicas.Usuario;
import dados.geral.DAOGenerico;

public class UsuarioDAO extends DAOGenerico<Usuario>{

	public UsuarioDAO(EntityManagerFactory emf) {
		super(emf);
	}


	public List<Usuario> getSolicitacoesPorSetor(String nome) {
		List<Usuario> instance = null;
		EntityManager em = this.getEntityManagerFactory().createEntityManager();
		try {
			String sql = "FROM " + getPersistentClass().getName() + " U WHERE U."+ Usuario.NOME +" LIKE :N";
			Query query =  em.createQuery(sql, Usuario.class);
			query.setParameter("N", "%" + nome + "%");

			instance = query.getResultList();
		} catch (RuntimeException re) {
			re.printStackTrace();
		}
		em.close();
		return instance;
	}

	public Usuario getUsuario(Usuario usuario){
		Usuario instance = null;
		EntityManager em = this.getEntityManagerFactory().createEntityManager();
		try {
			String sql = "FROM " + getPersistentClass().getName() + " U WHERE U."+ Usuario.NOME_USUARIO +" = :N AND U." + Usuario.SENHA + " = :S";
			Query query =  em.createQuery(sql, Usuario.class);
			query.setParameter("N", usuario.getNomeUsuario());
			query.setParameter("S", usuario.getSenha());

			instance = (Usuario)query.getSingleResult();
		} catch (RuntimeException re) {
			re.printStackTrace();
		}
		em.close();
		return instance;
	}
}
