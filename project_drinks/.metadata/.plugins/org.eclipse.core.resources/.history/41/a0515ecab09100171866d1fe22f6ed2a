<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:c="http://java.sun.com/jsp/jstl/core"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:p="http://primefaces.org/ui" lang="pt-BR">
<h:head>
	<title>Serviços Gerais</title>

	<meta http-equiv="content-type" content="text/html; charset=utf-8" />
	<ui:include src="/pages/dialog/atendimento.xhtml" />
	<ui:include src="/pages/dialog/confirm.xhtml" />
	<ui:include src="/pages/dialog/visualizar.xhtml" />
	<ui:include src="/pages/menu/menu.xhtml" />

</h:head>
<h:body>

	<h:form id="frmSearchList">
	<p:messages id="messages" />
		<p:panel id="listagem" header="Listagem" style="margin-bottom:20px">
			<p:dataTable id="dtTable" var="obj" value="#{solicitacaoBean.list}"
				paginator="true" rows="10"
				paginatorTemplate="{CurrentPageReport} {FirstPageLink} {PreviousPageLink} {PageLinks} {NextPageLink} {LastPageLink}"
				emptyMessage="Sem registros encontrados">

				<p:column headerText="Número" sortBy="#{obj.numeroSolicitacao}"
					filterMatchMode="contains">
					<h:outputText value="#{obj.numeroSolicitacao}" />
				</p:column>

				<p:column headerText="Solicitante" sortBy="#{obj.solicitante.nome}"
					filterMatchMode="contains">
					<h:outputText value="#{obj.solicitante.nome}" />
				</p:column>

				<p:column headerText="Tipo de Problema"
					sortBy="#{obj.tipoDeProblema.nome}" filterMatchMode="contains">
					<h:outputText value="#{obj.tipoDeProblema.nome}" />
				</p:column>
				<p:column headerText="Situação" sortBy="#{obj.situacao}"
					filterMatchMode="contains">
					<h:outputText value="#{obj.situacao.label} " />
				</p:column>
				
				<p:column headerText="Técnico"
					sortBy="#{obj.tecnicoAlocado.usuario.nome}" filterMatchMode="contains">
					<h:outputText value="#{obj.tecnicoAlocado.usuario.nome == null ?  ' - ' : obj.tecnicoAlocado.usuario.nome} " />
				</p:column>

				<p:column headerText="Ações">
					<p:commandButton icon="ui-icon-tag" update=":frmSearchList"
						onclick="PF('atendimento').show();" title="Iniciar Atendimento">
						<f:setPropertyActionListener
							target="#{solicitacaoBean.solicitacao}" value="#{obj}" />
					</p:commandButton>

					<p:commandButton icon="ui-icon-check" title="Concluir solicitação"
						rendered="#{obj.situacao != 'CONCLUIDO'}"
						action="#{solicitacaoBean.concluir(obj)}" update="@form">
						<p:confirm header="Confirmação"
							message="Deseja concluir a solicitação?" icon="ui-icon-alert" />
					</p:commandButton>
					
					

				</p:column>
			</p:dataTable>
		</p:panel>
	</h:form>
</h:body>
</html>